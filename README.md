# InternshipAvito
##Микросервис управления счетами и заказами пользователей

При выполнении задания ставил перед собой цель как можно более подробно разобраться в структуре и работе микросервисов и их их интерфейсами. По этой причине старался избегать использования фреймворков и различных библиотек-оберток. 

##Этапы Проектирования микросервиса:
1. Проектирование базы данных.
2. Проектирование интерфейсов.
3. Выстраивание архитектуры проекта.

###Проектирование базы данных
SQL код базы данных содержиться в файле SQL DB User Wallet.
Схема ниже.
![Untitled](https://user-images.githubusercontent.com/96218277/202832114-82297652-47bb-4471-ad20-338e155be3b4.png)

Было выделено 4 сущности: 
1. Пользователь - содержит ID и сведения о балансе
2. Услуга - содержит сведения об оказываемой пользователю услуге
3. Заказ - содержит сведения о типе услуги и пользователе, реализует связь Пользователь - Услуга мн ко мн.
4. Статус заказа - согласто техническому заданию, заказ может иметь несколько этапов: оплата, утверждение, отмена. О дате наступления каждого этапа необходимо хранить информацию в базе данных для реализации бухгалтерского отчета.

###2. Проектирование интерфейсов
При проектировании HTTP интерфейсов старался придерживаться архитектуры REST API.
+ HTTP Метод:URI:назначение
GET:/wallet/:Получить остаток на кошельке пользователя
Возвращаемые значения:
{
  "uid": $идентификатор пользователя
  "balance": $остаток на счету
}
Статус 500 - в случае если сведений о пользователе еще нет в базе данных
Обязательные заголовки:
Content-Type = application/json
Тело:
{
  "uid": $идентификатор пользователя
}

+ PUT:/wallet/:Пополнение кошелька пользователя
Возвращаемые значения:
Cтатус 201 - в случае успеха
Статус 500 - в случае если сведений о пользователе еще нет в базе данных
Обязательные заголовки:
Content-Type = application/json
Тело:
{
  "uid": $идентификатор пользователя
}

+ PUT:/transaction/:Создать заказ и зарезервировать деньги из кошелька пользователя
Возвращаемые значения:
Статус 201 - в случае успеха
Статус 500 - в случае, если пользователя нет в базе / у него недостаточно средств
Content-Type = application/json
Тело:
{
  "uid": $идентификатор пользователя
}
